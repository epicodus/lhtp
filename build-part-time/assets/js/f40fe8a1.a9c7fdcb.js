"use strict";(self.webpackChunklhtp=self.webpackChunklhtp||[]).push([[4134],{30876:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>u});var i=n(2784);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=i.createContext({}),d=function(e){var t=i.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},p=function(e){var t=d(e.components);return i.createElement(l.Provider,{value:t},e.children)},c="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},m=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=d(n),m=a,u=c["".concat(l,".").concat(m)]||c[m]||h[m]||o;return n?i.createElement(u,r(r({ref:t},p),{},{components:n})):i.createElement(u,r({ref:t},p))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,r=new Array(o);r[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[c]="string"==typeof e?e:a,r[1]=s;for(var d=2;d<o;d++)r[d]=n[d];return i.createElement.apply(null,r)}return i.createElement.apply(null,n)}m.displayName="MDXCreateElement"},31900:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>d});var i=n(7896),a=(n(2784),n(30876));const o={title:"The Identity Model",id:"the-identity-model",slug:"the-identity-model",hide_table_of_contents:!0,sidebar_position:5,day:"weekend",type:"lesson",url:"https://github.com/epicodus-curriculum/c-sharp-full-stack/blob/main/2da_identity_model.md"},r=void 0,s={unversionedId:"c-and-net/authentication-with-identity/the-identity-model",id:"c-and-net/authentication-with-identity/the-identity-model",title:"The Identity Model",description:"We've just updated our To Do List database to store Identity data. Let's pause for a second to check out the changes in MySQL Workbench. Or, check out the contents of the most recent migration file, which should be called something similar to 20230102230735_AddIdentity.cs and be located in the ToDoList/Migrations/ directory. We'll see many new tables created for Identity-related data! What we're seeing here is Identity's model.",source:"@site/docs/c-and-net/14_authentication-with-identity/2da-identity-model.md",sourceDirName:"c-and-net/14_authentication-with-identity",slug:"/c-and-net/authentication-with-identity/the-identity-model",permalink:"/c-and-net/authentication-with-identity/the-identity-model",draft:!1,tags:[],version:"current",sidebarPosition:5,frontMatter:{title:"The Identity Model",id:"the-identity-model",slug:"the-identity-model",hide_table_of_contents:!0,sidebar_position:5,day:"weekend",type:"lesson",url:"https://github.com/epicodus-curriculum/c-sharp-full-stack/blob/main/2da_identity_model.md"},sidebar:"c-and-net",previous:{title:"Identity Setup and Configuration",permalink:"/c-and-net/authentication-with-identity/identity-setup-and-configuration"},next:{title:"Authentication with Identity: User Registration Controller",permalink:"/c-and-net/authentication-with-identity/authentication-with-identity-user-registration-controller"}},l={},d=[{value:"The Identity Model",id:"the-identity-model",level:2},{value:"Entity Relationships",id:"entity-relationships",level:3},{value:"The <code>System.Security.Claims</code> Namespace",id:"the-systemsecurityclaims-namespace",level:3},{value:"Takeaways",id:"takeaways",level:3}],p={toc:d},c="wrapper";function h(e){let{components:t,...n}=e;return(0,a.kt)(c,(0,i.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"We've just updated our To Do List database to store Identity data. Let's pause for a second to check out the changes in MySQL Workbench. Or, check out the contents of the most recent migration file, which should be called something similar to ",(0,a.kt)("inlineCode",{parentName:"p"},"20230102230735_AddIdentity.cs")," and be located in the ",(0,a.kt)("inlineCode",{parentName:"p"},"ToDoList/Migrations/")," directory. We'll see many new tables created for Identity-related data! What we're seeing here is Identity's model."),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://learnhowtoprogram.s3.us-west-2.amazonaws.com/c%23/to-do-list-with-auth-database-schema.png",alt:"To Do List database schema with new Identity entities."})),(0,a.kt)("h2",{id:"the-identity-model"},"The Identity Model"),(0,a.kt)("hr",null),(0,a.kt)("p",null,"Each table focuses on different data that Identity uses to track its users, roles, claims, logins, and tokens:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"aspnetusers")," corresponds to ",(0,a.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.identity.identityuser?view=aspnetcore-6.0"},"the ",(0,a.kt)("inlineCode",{parentName:"a"},"IdentityUser")," class")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"aspnetroles")," corresponds to ",(0,a.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.identity.identityrole?view=aspnetcore-6.0"},"the ",(0,a.kt)("inlineCode",{parentName:"a"},"IdentityRole")," class")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"aspnetroleclaims")," corresponds to ",(0,a.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.identity.identityroleclaim-1?view=aspnetcore-6.0"},"the ",(0,a.kt)("inlineCode",{parentName:"a"},"IdentityRoleClaims<TKey>")," class")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"aspnetuserclaims")," corresponds to ",(0,a.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.identity.identityuserclaim-1?view=aspnetcore-6.0"},"the ",(0,a.kt)("inlineCode",{parentName:"a"},"IdentityUserClaim<TKey>")," class")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"aspnetuserlogins")," corresponds to ",(0,a.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.identity.identityuserlogin-1?view=aspnetcore-6.0"},"the ",(0,a.kt)("inlineCode",{parentName:"a"},"IdentityUserLogin<TKey>")," class")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"aspnetuserroles")," corresponds to ",(0,a.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.identity.identityuserrole-1?view=aspnetcore-6.0"},"the ",(0,a.kt)("inlineCode",{parentName:"a"},"IdentityUserRole<TKey>")," class")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"aspnetusertokens")," corresponds to ",(0,a.kt)("a",{parentName:"li",href:"https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.identity.identityusertoken-1?view=aspnetcore-6.0"},"the ",(0,a.kt)("inlineCode",{parentName:"a"},"IdentityUserToken<TKey>")," class"))),(0,a.kt)("p",null,"We only have an ",(0,a.kt)("inlineCode",{parentName:"p"},"ApplicationUser : IdentityUser")," model explicitly in our To Do list app. We also haven't updated our ",(0,a.kt)("inlineCode",{parentName:"p"},"ToDoListContext")," with the above entities either! So how do these entities get added to our database? It happens implicitly so long as we've configured Identity to work with EF Core and our To Do List database context! (Of course, we still need to create a migration and update the database.) "),(0,a.kt)("p",null,"In fact, we only created the ",(0,a.kt)("inlineCode",{parentName:"p"},"ApplicationUser")," model in our application so that we have the option to customize it with custom user data."),(0,a.kt)("p",null,"Because all of the Identity entities are added to our database implicitly, the docs make sure to clearly explain the Identity model and the purpose of each. First, check our the following table ",(0,a.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/aspnet/core/security/authentication/customize-identity-model?view=aspnetcore-6.0"},"from the MS docs")," that explains each entity type:"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://learnhowtoprogram.s3.us-west-2.amazonaws.com/c%23/aspnet-identity-model.png",alt:"Table listing the Identity model and entities."})),(0,a.kt)("p",null,"While the table does a good job listing what each entity represents, some of these could use more explanation. "),(0,a.kt)("p",null,"Let's start with ",(0,a.kt)("strong",{parentName:"p"},"user"),". A user is someone who uses our website. They've created an account and their user information is saved and managed with Identity. We'll ask our users to provide their email and password to create a unique user account. Then when users log in, they will provide their email and password, and Identity will use that information in order to verify the user's identity. "),(0,a.kt)("p",null,"A ",(0,a.kt)("strong",{parentName:"p"},"role"),' is a category, like "manager" or "admin", that we can give to certain users. We can then set up different permissions (using authorization) for each role, which will determine what that role can do in our website. The ',(0,a.kt)("strong",{parentName:"p"},"user role")," model is meant to associate users with roles."),(0,a.kt)("p",null,"A ",(0,a.kt)("strong",{parentName:"p"},"claim")," is a name-value pair that represents who a user is. Claims can be created from any user or identity data, and this data can be issued from ASP.NET Core identity or another trusted identity provider. There's a model for both ",(0,a.kt)("strong",{parentName:"p"},"user claim")," and ",(0,a.kt)("strong",{parentName:"p"},"role claim"),", which means we can create claims based on user data or role data. We won't be creating claims, but letting Identity generate claims instead."),(0,a.kt)("p",null,"A ",(0,a.kt)("strong",{parentName:"p"},"user login")," is the model that tracks users with logins using third-party providers, like Google or Facebook."),(0,a.kt)("p",null,"A ",(0,a.kt)("strong",{parentName:"p"},"user token")," is the model that associates a token with a user for token-based authentication. "),(0,a.kt)("p",null,"We won't be creating or managing roles, claims, logins, or tokens in the simple implementation of authentication that we'll add to our To Do List app. We'll stick to creating users, and using email and password credentials to authenticate. ",(0,a.kt)("strong",{parentName:"p"},"This means that we'll only end up using the ",(0,a.kt)("inlineCode",{parentName:"strong"},"aspnetusers")," table in our database,")," which corresponds to the ",(0,a.kt)("inlineCode",{parentName:"p"},"ApplicationUser")," class in our To Do List models."),(0,a.kt)("p",null,"There are further exploration opportunities to implement other authentication schemes that do end up using the other tables in our database. An authentication ",(0,a.kt)("strong",{parentName:"p"},"scheme")," is a method of authentication. For example, Identity, ",(0,a.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.authentication.cookies?view=aspnetcore-6.0"},"cookies"),", and ",(0,a.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.authentication.jwtbearer?view=aspnetcore-6.0"},"JWT Bearer")," are all different authentication schemes we can use in ASP.NET Core apps. To learn more about further exploration opportunities, visit the lesson ",(0,a.kt)("a",{parentName:"p",href:"https://new.learnhowtoprogram.com/c-and-net/authentication-with-identity/further-exploration-opportunities-with-identity"},"Further Exploration with Identity"),"."),(0,a.kt)("h3",{id:"entity-relationships"},"Entity Relationships"),(0,a.kt)("p",null,"It's also helpful to take a look at the relationships between each Identity entity. ",(0,a.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/aspnet/core/security/authentication/customize-identity-model?view=aspnetcore-6.0"},"The MS docs")," has a handy list that clearly explains the relationships in the Identity model:"),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://learnhowtoprogram.s3.us-west-2.amazonaws.com/c%23/aspnet-identity-relationships.png",alt:"List describing the relationship between each Identity entity."})),(0,a.kt)("p",null,"Again, we'll only be using the ",(0,a.kt)("inlineCode",{parentName:"p"},"Users")," model \u2014 the ",(0,a.kt)("inlineCode",{parentName:"p"},"ApplicationUser")," model in our To Do List app."),(0,a.kt)("h3",{id:"the-systemsecurityclaims-namespace"},"The ",(0,a.kt)("inlineCode",{parentName:"h3"},"System.Security.Claims")," Namespace"),(0,a.kt)("p",null,"Identity is responsible for providing a ",(0,a.kt)("a",{parentName:"p",href:"https://learn.microsoft.com/en-us/dotnet/api/system.security.claims.claimsprincipal?view=net-6.0"},(0,a.kt)("inlineCode",{parentName:"a"},"ClaimsPrinciple"))," when a user logs in to our To Do List website. The ",(0,a.kt)("inlineCode",{parentName:"p"},"ClaimsPrinciple")," contains information about the user's ",(0,a.kt)("strong",{parentName:"p"},"claim"),", their identity as verified by ASP.NET Core Identity. "),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"ClaimsPrinciple")," is just one class of many within the ",(0,a.kt)("inlineCode",{parentName:"p"},"System.Security.Claims")," namespace. This namespace has other classes that describe claims in general. As we'll see when we update our views and controllers, we'll access certain class properties and methods from the ",(0,a.kt)("inlineCode",{parentName:"p"},"System.Security.Claims")," namespace (among others) in order to determine a few things:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"Is there an authenticated user? "),(0,a.kt)("li",{parentName:"ul"},"What's the name (email) of the authenticated user? "),(0,a.kt)("li",{parentName:"ul"},"How do I get the entire ",(0,a.kt)("inlineCode",{parentName:"li"},"ApplicationUser")," object for the logged in user? We will need the ",(0,a.kt)("inlineCode",{parentName:"li"},"ApplicationUser")," object when we want to associate To Do List models (like ",(0,a.kt)("inlineCode",{parentName:"li"},"Item")," or ",(0,a.kt)("inlineCode",{parentName:"li"},"Category"),") with a specific user. ")),(0,a.kt)("h3",{id:"takeaways"},"Takeaways"),(0,a.kt)("p",null,"The namespaces and classes that support authentication in ASP.NET Core applications can be overwhelming to navigate and understand. That's because there are many different authentication schemes that we can implement in our ASP.NET Core applications. It's not so important to understand the classes or namespaces, but instead the tools and concepts that impact our To Do List application:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"We'll be using the ",(0,a.kt)("inlineCode",{parentName:"li"},"aspnetusers")," table in our To Do List database to save user data, like their email and password. The ",(0,a.kt)("inlineCode",{parentName:"li"},"aspnetusers")," table corresponds to the ",(0,a.kt)("inlineCode",{parentName:"li"},"ApplicationUser")," model in our project."),(0,a.kt)("li",{parentName:"ul"},"Identity will handle authenticating users based on their email and password. In the process, Identity will generate a ",(0,a.kt)("inlineCode",{parentName:"li"},"ClaimsPrinciple")," for the user, which contains a claim about the user's identity as verified by ASP.NET Core Identity."),(0,a.kt)("li",{parentName:"ul"},"We can access the ",(0,a.kt)("inlineCode",{parentName:"li"},"ClaimsPrinciple")," that Identity generates to get information about the logged in user in order to conditionally display information in our website, or associate our To Do List models (like ",(0,a.kt)("inlineCode",{parentName:"li"},"Item")," or ",(0,a.kt)("inlineCode",{parentName:"li"},"Category"),") with specific users. "),(0,a.kt)("li",{parentName:"ul"},"We won't be creating or managing roles, (third-party) logins, tokens, or claims in our To Do List application. Those entity types have to do with other authentication schemes, and you can learn how to implement them if you do further exploration outside of the LearnHowToProgram.com curriculum.")))}h.isMDXComponent=!0}}]);